<?xml version="1.0" encoding="UTF-8"?>
<mod>
    <require file="apply-action.xml"/>
    
    <action name="move">
        <object name="subject"/>
        <integer name="dx"/>
        <integer name="dy"/>
        
        <code>
subject.move(dx, dy)

# process traps
tile = subject.getTile()
traps = tile.get('trap')
if traps:
    try:
        ti = iter(traps)
    except TypeError:
        traps = [traps]
    for trap in traps:
        # TODO: random
        action('apply', {'subject' : trap, 'target' : subject})
else:
    info('user was lucky enough to not step on the trap')
        </code>
    </action>
</mod>
